---
editor_options: 
  markdown: 
    wrap: 72
---

# Introdução: erro total e qualidade na produção estatística

Neste capítulo vamos relembrar a decomposição do **erro total** em
pesquisas amostrais e simular pequenos exemplos em R.

A ideia central é:

\text{ESTIMATIVA} = \text{VALOR_VERDADEIRO} + \text{ERRO_TOTAL}

$$


\text{ESTIMATIVA}\quad \Rightarrow \quad Est \\
\text{ } \\
\text{VALOR TOTAL}\quad \Rightarrow \quad vV \\
\text{ } \\
\text{ERRO TOTAL}\quad \Rightarrow \quad errT \\
\text{ } \\

\qquad Est =  ( vV ) + ( errT )


$$

onde o erro total é decomposto em:

-   **Erro amostral** – decorrente de observar apenas uma amostra da
    população;
-   **Erro não-amostral** – associado à especificação, coleta, medição,
    processamento etc.

## Exercício 1 – Simulando erro amostral

Considere que o verdadeiro rendimento médio mensal da população de um
município seja R\$ 2.000, com desvio-padrão de R\$ 800.

1.  Simule em R uma população fictícia de 100.000 indivíduos.
2.  A partir dessa população, extraia 1.000 amostras aleatórias simples
    de tamanho 200.
3.  Para cada amostra, calcule a média amostral.
4.  Faça um histograma das médias amostrais e estime:
    -   o viés (diferença entre média das médias amostrais e o valor
        verdadeiro 2.000);
    -   o desvio-padrão das médias amostrais (erro padrão).

```{r exercicio1-erro-amostral, message=FALSE, warning=FALSE}
set.seed(123)

# 1. População fictícia
N <- 100000
renda_pop <- rnorm(N, mean = 2000, sd = 800)

# 2. Amostragem repetida
B <- 1000
n <- 200

medias <- numeric(B)

for (b in 1:B) {
  amostra <- sample(renda_pop, size = n, replace = FALSE)
  medias[b] <- mean(amostra)
}

# 3. Sumário
mean_verdadeira <- mean(renda_pop)
mean_medias <- mean(medias)
sd_medias <- sd(medias)

mean_verdadeira
mean_medias
sd_medias

# 4. Histograma
hist(medias,
     main = "Distribuição das médias amostrais (n = 200)",
     xlab = "Média amostral")
abline(v = mean_verdadeira, lwd = 2, lty = 2)
```

### Perguntas de interpretação

-   O viés observado é grande ou pequeno em relação a 2.000?
-   Como o desvio-padrão das médias se compara ao desvio-padrão da
    população?
-   Se aumentarmos o tamanho da amostra para 800, o que esperamos que
    aconteça com o desvio-padrão das médias amostrais?

## Exercício 2 – Introduzindo um erro de medição

Agora vamos introduzir um **erro de medição** simples: suponha que, em
média, o entrevistador subestime em 10% o rendimento dos entrevistados
com renda acima de R\$ 3.000.

1.  A partir da mesma população fictícia, crie uma variável
    `renda_observada` com a seguinte regra:

    -   se `renda_pop > 3000`, então
        `renda_observada = 0.9 * renda_pop`;
    -   caso contrário, `renda_observada = renda_pop`.

2.  Repita o mesmo processo de amostragem do Exercício 1, mas agora
    calcule as médias usando `renda_observada`.

3.  Compare o novo viés com o viés do Exercício 1.

```{r exercicio2-erro-medicao, message=FALSE, warning=FALSE}
# 1. Criar renda observada com erro de medição
renda_obs <- ifelse(renda_pop > 3000, 0.9 * renda_pop, renda_pop)

B <- 1000
n <- 200
medias_obs <- numeric(B)

for (b in 1:B) {
  amostra_idx <- sample(1:N, size = n, replace = FALSE)
  medias_obs[b] <- mean(renda_obs[amostra_idx])
}

mean_medias_obs <- mean(medias_obs)
sd_medias_obs   <- sd(medias_obs)

mean_medias_obs
sd_medias_obs
```

### Perguntas de interpretação

-   Qual é agora o viés em relação ao valor verdadeiro (2.000)?
-   A variabilidade das médias mudou muito?
-   Este erro está mais relacionado a **erro amostral** ou
    **não-amostral**? Justifique.

```{r imprimir-01, eval=FALSE, include=FALSE}
rmarkdown::render("01-introducao-qualidade.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```
